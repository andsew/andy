Phase 1: "I'd like to Teach the World to Ping"
	•	Note that /28 indicated we have a range available 32-28=4, 4*4= 16 ranges are left  
Determined the IP ranges for Hollywood Database Servers to scan were 15.199.95.80 to 15.199.95.95, then run:
 sysadmin@UbuntuDesktop:~$ fping -c 4  -g 15.199.95.80 15.199.95.95

15.199.95.80 : xmt/rcv/%loss = 4/0/100%
15.199.95.81 : xmt/rcv/%loss = 4/0/100%
15.199.95.82 : xmt/rcv/%loss = 4/0/100%
15.199.95.83 : xmt/rcv/%loss = 4/0/100%
15.199.95.84 : xmt/rcv/%loss = 4/0/100%
15.199.95.85 : xmt/rcv/%loss = 4/0/100%
15.199.95.86 : xmt/rcv/%loss = 4/0/100%
15.199.95.87 : xmt/rcv/%loss = 4/0/100%
15.199.95.88 : xmt/rcv/%loss = 4/0/100%
15.199.95.89 : xmt/rcv/%loss = 4/0/100%
15.199.95.90 : xmt/rcv/%loss = 4/0/100%
15.199.95.91 : xmt/rcv/%loss = 4/0/100%
15.199.95.92 : xmt/rcv/%loss = 4/0/100%
15.199.95.93 : xmt/rcv/%loss = 4/0/100%
15.199.95.94 : xmt/rcv/%loss = 4/0/100%
15.199.95.95 : xmt/rcv/%loss = 4/0/100%

Determined the IP ranges for Hollywood Web Servers to scan were 15.199.94.80 to 15.199.94.95, then run:
sysadmin@UbuntuDesktop:~$ fping -c 4  -g 15.199.94.80 15.199.94.95

15.199.94.80 : xmt/rcv/%loss = 4/0/100%
15.199.94.81 : xmt/rcv/%loss = 4/0/100%
15.199.94.82 : xmt/rcv/%loss = 4/0/100%
15.199.94.83 : xmt/rcv/%loss = 4/0/100%
15.199.94.84 : xmt/rcv/%loss = 4/0/100%
15.199.94.85 : xmt/rcv/%loss = 4/0/100%
15.199.94.86 : xmt/rcv/%loss = 4/0/100%
15.199.94.87 : xmt/rcv/%loss = 4/0/100%
15.199.94.88 : xmt/rcv/%loss = 4/0/100%
15.199.94.89 : xmt/rcv/%loss = 4/0/100%
15.199.94.90 : xmt/rcv/%loss = 4/0/100%
15.199.94.91 : xmt/rcv/%loss = 4/0/100%
15.199.94.92 : xmt/rcv/%loss = 4/0/100%
15.199.94.93 : xmt/rcv/%loss = 4/0/100%
15.199.94.94 : xmt/rcv/%loss = 4/0/100%
15.199.94.95 : xmt/rcv/%loss = 4/0/100%

Determined the IP ranges for Hollywood Web Servers to scan were 11.199.158.80 to 11.199.158.95, then run:
sysadmin@UbuntuDesktop:~$ fping -c 4  -g 11.199.158.80 11.199.158.95

11.199.158.80 : xmt/rcv/%loss = 4/0/100%
11.199.158.81 : xmt/rcv/%loss = 4/0/100%
11.199.158.82 : xmt/rcv/%loss = 4/0/100%
11.199.158.83 : xmt/rcv/%loss = 4/0/100%
11.199.158.84 : xmt/rcv/%loss = 4/0/100%
11.199.158.85 : xmt/rcv/%loss = 4/0/100%
11.199.158.86 : xmt/rcv/%loss = 4/0/100%
11.199.158.87 : xmt/rcv/%loss = 4/0/100%
11.199.158.88 : xmt/rcv/%loss = 4/0/100%
11.199.158.89 : xmt/rcv/%loss = 4/0/100%
11.199.158.90 : xmt/rcv/%loss = 4/0/100%
11.199.158.91 : xmt/rcv/%loss = 4/0/100%
11.199.158.92 : xmt/rcv/%loss = 4/0/100%
11.199.158.93 : xmt/rcv/%loss = 4/0/100%
11.199.158.94 : xmt/rcv/%loss = 4/0/100%
11.199.158.95 : xmt/rcv/%loss = 4/0/100%


Determined the IP ranges for Hollywood Application Servers to scan was 167.172.144.11, only because /32 indicates bits and all variations are taken so we then run:
sysadmin@UbuntuDesktop:~$ ping -c 4 167.172.144.11
PING 167.172.144.11 (167.172.144.11) 56(84) bytes of data.
64 bytes from 167.172.144.11: icmp_seq=1 ttl=63 time=82.4 ms
64 bytes from 167.172.144.11: icmp_seq=2 ttl=63 time=82.0 ms
64 bytes from 167.172.144.11: icmp_seq=3 ttl=63 time=99.5 ms
64 bytes from 167.172.144.11: icmp_seq=4 ttl=63 time=90.8 ms

--- 167.172.144.11 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3159ms
rtt min/avg/max/mdev = 82.081/88.726/99.532/7.165 ms
	•	We have an IP which is responsive, received 4 packets and transmitted back 4 packets, which the company RockStar Corp doesn't want,this is a vulnerability. 

Determined the IP ranges for Hollywood Application Servers to scan were 11.199.141.80 to 11.199.141.95, then run:
sysadmin@UbuntuDesktop:~$ fping -c 4  -g 11.199.141.80 11.199.141.95

11.199.141.80 : xmt/rcv/%loss = 4/0/100%
11.199.141.81 : xmt/rcv/%loss = 4/0/100%
11.199.141.82 : xmt/rcv/%loss = 4/0/100%
11.199.141.83 : xmt/rcv/%loss = 4/0/100%
11.199.141.84 : xmt/rcv/%loss = 4/0/100%
11.199.141.85 : xmt/rcv/%loss = 4/0/100%
11.199.141.86 : xmt/rcv/%loss = 4/0/100%
11.199.141.87 : xmt/rcv/%loss = 4/0/100%
11.199.141.88 : xmt/rcv/%loss = 4/0/100%
11.199.141.89 : xmt/rcv/%loss = 4/0/100%
11.199.141.90 : xmt/rcv/%loss = 4/0/100%
11.199.141.91 : xmt/rcv/%loss = 4/0/100%
11.199.141.92 : xmt/rcv/%loss = 4/0/100%
11.199.141.93 : xmt/rcv/%loss = 4/0/100%
11.199.141.94 : xmt/rcv/%loss = 4/0/100%
11.199.141.95 : xmt/rcv/%loss = 4/0/100%

I also tried to fping the five IP addresses to see if they would respond with out the range and got the following: 
	•	Commands used to check if any IP addresses are active and responsive: 
sysadmin@UbuntuDesktop:~$ fping 15.199.95.91 15.199.94.91 11.199.158.91 167.172.144.11 11.199.141.91
167.172.144.11 is alive
15.199.95.91 is unreachable
15.199.94.91 is unreachable
11.199.158.91 is unreachable
11.199.141.91 is unreachable

	•	As we see above we have one IP address which is active and responsive. The Hollywood Application Server with IP address 167.172.144.11 is alive. 
	•	RockStar Corp doesn't want to respond to any requests, this is a vulnerability. This IP Address is responding to the PING request. 
	•	Recommend to have a Firewall to ignore or block the ping requests. 
	•	This occurred on the network layer as Ping uses IP addresses and IPs are used on the Network Layer.   
Phase 2: "Some Syn for Nothin`"
Run nmap command as follows:
sysadmin@UbuntuDesktop:~$ sudo nmap -sS 167.172.144.11
[sudo] password for sysadmin: 

Starting Nmap 7.60 ( https://nmap.org ) at 2021-10-28 14:39 EDT
Stats: 0:03:11 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 85.77% done; ETC: 14:43 (0:00:32 remaining)
Nmap scan report for 167.172.144.11
Host is up (0.088s latency).
Not shown: 995 closed ports
PORT    STATE    SERVICE
22/tcp  open     ssh
25/tcp  filtered smtp
135/tcp filtered msrpc
139/tcp filtered netbios-ssn
445/tcp filtered microsoft-ds

Nmap done: 1 IP address (1 host up) scanned in 251.56 seconds

	•	As we see the the SYN SCAN shows port 22/tcp is open with ssh  
	•	The OSI Layer where we found our open port is on the Transport Layer (4) where the port is used to send and receive data. 
	•	Mitigation strategy: 22/tcp state should not be open it should be filtered ssh meaning there should be a firewall protecting that port. 

Phase 3: "I Feel a DNS Change Comin' On"

Accessing Server: sysadmin@UbuntuDesktop:~$ sudo ssh jimi@167.172.144.11
Password: hendrix
	•	While logged into the RockStar server was able to move to the /etc/hosts file and see the following: 
 Your system has configured 'manage_etc_hosts' as True.
# As a result, if you wish for changes to this file to persist
# then you will need to either
# a.) make changes to the master file in /etc/cloud/templates/hosts.tmpl
# b.) change or remove the value of 'manage_etc_hosts' in
#     /etc/cloud/cloud.cfg or cloud-config from user-data
#
127.0.1.1 GTscavengerHunt.localdomain GTscavengerHunt
127.0.0.1 localhost
98.137.246.8 rollingstone.com

oooooooollowing lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

-The rollingstone.com has been hijacked by the hacker or whoever the person of interest, to the IP address of 98.137.246.8 which is owned by the hacker/person of interest.

Exit from SSH session 

Then run sysadmin@UbuntuDesktop:~$ nslookup 98.137.246.8 
8.246.137.98.in-addr.arpa	name = unknown.yahoo.com.

*This shows that rollingstong.com was actually going to unknown.yahoo.com

This is found on the Application Layer (7) of the OSI model. 
-Mitigation strategy: The host file needs to be only edited by admins only and not end user/perpetrators and edit the rollingstone.com IP and redirect to another IP Address as we see here. The editing privileges should only be for admins and not any other users.


Phase 4: "ShARP Dressed Man"

We first log in with ssh sysadmin@UbuntuDesktop:~$ sudo ssh jimi@167.172.144.11

$ cd ls etc
$ cat packetcaptureinfo.txt
 Captured Packets are here:
 https://drive.google.com/file/d/1ic-CFFGrbruloYrWaw3PvT71elTkh3eF/view?usp=sharing

Open the link and download the pcapng file then open with wireshark

Filter using http

	•	Http findings show: The hacker noting that he has discovered a port 22 open with SHH and has the user and password. 

Frame 16: 1876 bytes on wire (15008 bits), 1876 bytes captured (15008 bits) on interface any, id 0
Linux cooked capture v1
Internet Protocol Version 4, Src: 10.0.2.15 (10.0.2.15), Dst: 104.18.126.89 (104.18.126.89)
Transmission Control Protocol, Src Port: 33546, Dst Port: 80, Seq: 1, Ack: 1, Len: 1820
Hypertext Transfer Protocol
HTML Form URL Encoded: application/x-www-form-urlencoded
    Form item: "0<text>" = "Mr Hacker"
    Form item: "0<label>" = "Name"
    Form item: "1<text>" = "Hacker@rockstarcorp.com"
    Form item: "1<label>" = "Email"
    Form item: "2<text>" = ""
    Form item: "2<label>" = "Phone"
    Form item: "3<textarea>" = "Hi Got The Blues Corp!  This is a hacker that works at Rock Star Corp.  Rock Star has left port 22, SSH open if you want to hack in.  For 1 Milliion Dollars I will provide you the user and password!"
        Key: 3<textarea>
        Value: Hi Got The Blues Corp!  This is a hacker that works at Rock Star Corp.  Rock Star has left port 22, SSH open if you want to hack in.  For 1 Milliion Dollars I will provide you the user and password!
    Form item: "3<label>" = "Message"
    Form item: "redirect" = "http://www.gottheblues.yolasite.com/contact-us.php?formI660593e583e747f1a91a77ad0d3195e3Posted=true"
    Form item: "locale" = "en"
    Form item: "redirect_fail" = "http://www.gottheblues.yolasite.com/contact-us.php?formI660593e583e747f1a91a77ad0d3195e3Posted=false"
    Form item: "form_name" = ""
    Form item: "site_name" = "GottheBlues"
    Form item: "wl_site" = "0"
    Form item: "destination" = "DQvFymnIKN6oNo284nIPnKyVFSVKDX7O5wpnyGVYZ_YSkg==:3gjpzwPaByJLFcA2ouelFsQG6ZzGkhh31_Gl2mb5PGk="
    Form item: "g-recaptcha-response" = "03AOLTBLQA9oZg2Lh3adsE0c7OrYkMw1hwPof8xGnYIsZh8cz5TtLwl8uDMZuVOls6duzyYq2MTzsVHYzKda77dqzzNUwpa6F5Tu6b9875yKU1wZHpfOQmV8D7OTcx2rnGD6I8s-6qvyDAjCuS6vA78-iNLNUtWZXFJwleNj3hPquVMu-yzcSOX60Y-deZC8zXn8hu4c6u

	•	The above readable message is found on the http which is found in the Application Layer (7) of the OSI model. 

Filter using arp.opcode==2
[Duplicate IP address detected for 192.168.47.200 (00:0c:29:1d:b3:b1) - also in use by 00:0c:29:0f:71:a3 (frame 4)]
[Expert Info (Warning/Sequence): Duplicate IP address configured (192.168.47.200)]

	•	So ARP (Address Resolution Protocol) works on the Data Link Layer (2) since it connects IP address to a fixed physical machine address also known as media access control (MAC) Address.  
	•	Mitigation Strategy: Maybe hire a third party company that detects unusual activity like Duplicate IP like cloudflare for instance can be a third party company to help detect suspicious activities and notify of the issue.  
